{% extends 'base.html' %}
{% block content %}
<div class="row g-4">
  <div class="col-lg-4">
    <div class="card shadow-sm">
      <div class="card-header bg-white"><strong>Create Batch</strong></div>
      <div class="card-body">
        <form method="post">
          <div class="mb-3"><label class="form-label">Batch No</label><input class="form-control" name="batch_no" placeholder="BAT-0003" required></div>
          <div class="mb-3"><label class="form-label">Job</label>
            <select class="form-select" name="job_id" required>
              <option value="">Select job</option>
              {% for row in jobs %}<option value="{{ row.id }}">{{ row.job_no }} / {{ row.customer_name }} / {{ row.product_name }}</option>{% endfor %}
            </select>
          </div>
          <div class="mb-3"><label class="form-label">Recipe Code</label><input class="form-control" name="recipe_code" placeholder="RCP-C3"></div>
          <div class="mb-3"><label class="form-label">Planned Input KG</label><input class="form-control" type="number" step="0.01" name="planned_input_kg" required></div>
          <div class="mb-3"><label class="form-label">Assigned Line</label>
            <select class="form-select" name="assigned_line_id">
              <option value="">No line yet</option>
              {% for row in lines %}<option value="{{ row.id }}">{{ row.code }} / {{ row.name }}</option>{% endfor %}
            </select>
          </div>
          <div class="mb-3"><label class="form-label">Barcode Text</label><input class="form-control" name="barcode_text" placeholder="Leave blank to use batch no"></div>
          <button class="btn btn-dark w-100">Create Batch</button>
        </form>
      </div>
    </div>
  </div>
  <div class="col-lg-8">
    <div class="card shadow-sm">
      <div class="card-header bg-white"><strong>Batches</strong></div>
      <div class="card-body table-responsive">
        <table class="table table-striped table-sm align-middle">
          <thead><tr><th>Batch No</th><th>Job No</th><th>Customer</th><th>Product</th><th>Input KG</th><th>Line</th><th>Current Process</th><th>Status</th></tr></thead>
          <tbody>
            {% for row in rows %}
            <tr>
              <td>{{ row.batch_no }}</td>
              <td>{{ row.job_no }}</td>
              <td>{{ row.customer_name }}</td>
              <td>{{ row.product_name }}</td>
              <td>{{ row.planned_input_kg }}</td>
              <td>{{ row.line_name or '-' }}</td>
              <td><span class="badge text-bg-info">{{ row.current_process }}</span></td>
              <td><span class="badge text-bg-secondary">{{ row.status }}</span></td>
            </tr>
            {% else %}
            <tr><td colspan="8" class="text-center text-muted">No batches yet.</td></tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>
{% endblock %}
